-- MySQL Script generated by MySQL Workbench
-- Sat Aug 28 19:38:16 2021
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema reto4
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema reto4
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `reto4` DEFAULT CHARACTER SET utf8 ;
USE `reto4` ;

-- -----------------------------------------------------
-- Table `reto4`.`TIPO_PLATO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reto4`.`TIPO_PLATO` (
  `tp_plt_id` INT NOT NULL auto_increment,
  `tp_plt_nombre` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`tp_plt_id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reto4`.`PLATO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reto4`.`PLATO` (
  `plt_id` INT NOT NULL auto_increment,
  `plt_nombre` VARCHAR(200) NOT NULL,
  `plt_precio` INT NOT NULL,
  `plt_descripcion` VARCHAR(300) NULL,
  `TIPO_PLATO_tp_plt_id` INT NOT NULL,
  PRIMARY KEY (`plt_id`),
  INDEX `fk_PLATO_TIPO_PLATO1_idx` (`TIPO_PLATO_tp_plt_id` ASC) VISIBLE,
  CONSTRAINT `fk_PLATO_TIPO_PLATO1`
    FOREIGN KEY (`TIPO_PLATO_tp_plt_id`)
    REFERENCES `reto4`.`TIPO_PLATO` (`tp_plt_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reto4`.`MESERO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reto4`.`MESERO` (
  `mes_id` INT NOT NULL auto_increment,
  `mes_nombre` VARCHAR(200) NOT NULL,
  `mes_apellidos` VARCHAR(200) NOT NULL,
  `mes_documento` BIGINT(40)NOT NULL,
  `mes_correo` VARCHAR(100) NULL,
  `mes_telefono` BIGINT(40) NULL,
  PRIMARY KEY (`mes_id`))
ENGINE = InnoDB
COMMENT = '	\n				';


-- -----------------------------------------------------
-- Table `reto4`.`CLIENTE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reto4`.`CLIENTE` (
  `cli_id` INT NOT NULL auto_increment,
  `cli_nombres` VARCHAR(100) NOT NULL,
  `cli_apellidos` VARCHAR(100) NOT NULL,
  `cli_documento` BIGINT(40)NOT NULL,
  `cli_telefono` BIGINT(40) NULL,
  PRIMARY KEY (`cli_id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reto4`.`ORDEN`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reto4`.`ORDEN` (
  `ordn_id` INT NOT NULL auto_increment,
  `ordn_fecha` DATE NULL,
  `PLATO_plt_id` INT NOT NULL,
  `MESERO_mes_id` INT NOT NULL,
  `CLIENTE_cli_id` INT NOT NULL,
  PRIMARY KEY (`ordn_id`, `PLATO_plt_id`, `MESERO_mes_id`),
  INDEX `fk_ORDEN_PLATO1_idx` (`PLATO_plt_id` ASC) VISIBLE,
  INDEX `fk_ORDEN_MESERO1_idx` (`MESERO_mes_id` ASC) VISIBLE,
  INDEX `fk_ORDEN_CLIENTE1_idx` (`CLIENTE_cli_id` ASC) VISIBLE,
  CONSTRAINT `fk_ORDEN_PLATO1`
    FOREIGN KEY (`PLATO_plt_id`)
    REFERENCES `reto4`.`PLATO` (`plt_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ORDEN_MESERO1`
    FOREIGN KEY (`MESERO_mes_id`)
    REFERENCES `reto4`.`MESERO` (`mes_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ORDEN_CLIENTE1`
    FOREIGN KEY (`CLIENTE_cli_id`)
    REFERENCES `reto4`.`CLIENTE` (`cli_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- tipo de plato
insert into TIPO_PLATO values (1, "Entrada");
insert into TIPO_PLATO values (2, "Plato Principal");
insert into TIPO_PLATO values (3, "Postres");
insert into TIPO_PLATO values (4, "Sopas");


-- platos

insert into PLATO values(1 , "Chicharrones", 19000, "Acompañados con papa Criolla", 1);
insert into PLATO values(2 , "Ojo de Bife", 45000, "Corte premium del bife ancho de la chata de contextura tierna y jugosa", 2);
insert into plato values(3, "Chuletón", 48000, "Jugoso corte de chatas con hueso, buen marmoleo y maduración intermedia",2);
insert into plato values(4, "Napoleón", 9500, "Disfruta de seis capas frescas y crocantes de hojaldre, con un delicioso relleno de arequipe entre capa y capa", 3);
insert into plato values(5, "Sopa de Cuchuco grande", 26000, "Incluye arroz blanco, arepa y aguacate", 4);
insert into plato values(6, "Mojarra", 29000, "Asada al carbón, acompañada de papa, yuca al vapor, arepa y guacamole", 2);




-- meseros

insert into mesero values(1, "Juan", "Perez", 110000, "juanperez112@google.com", 338771220);
insert into mesero values(2, "Maria", "Jimenez", 131420,"ma665re@yihoo.com", 258605531);
insert into mesero values(3, "Esther", "Hernández", 156179, "esther21@hotmailcito.com", 490113762);



-- clientes 

insert into cliente values(1, "Martha", "Gomez",1542300, 478585771);
insert into cliente values(2, "Roberto", "Malagón",3578300, 344116771);
insert into cliente values(3, "Verónica", "Salcedo", 9371641, 293565431);
insert into cliente values(4, "Pedro", "Lizarazo", 9371641, 478585771);

-- ordenes 

insert into orden(ordn_id, ordn_fecha, PLATO_plt_id, MESERO_mes_id, CLIENTE_cli_id) values(1, "2021-01-12", 2, 1, 1);
insert into orden(ordn_id, ordn_fecha, PLATO_plt_id, MESERO_mes_id, CLIENTE_cli_id) values(2, "2021-02-11", 3, 2, 2);
insert into orden(ordn_id, ordn_fecha, PLATO_plt_id, MESERO_mes_id, CLIENTE_cli_id) values(3, "2021-02-15", 4, 1, 2);
insert into orden(ordn_id, ordn_fecha, PLATO_plt_id, MESERO_mes_id, CLIENTE_cli_id) values(4, "2021-03-01", 3, 3, 3);
insert into orden(ordn_id, ordn_fecha, PLATO_plt_id, MESERO_mes_id, CLIENTE_cli_id) values(5, "2021-01-11", 4, 1, 4);
insert into orden(ordn_id, ordn_fecha, PLATO_plt_id, MESERO_mes_id, CLIENTE_cli_id) values(6, "2021-08-11", 2, 2, 2);
insert into orden(ordn_id, ordn_fecha, PLATO_plt_id, MESERO_mes_id, CLIENTE_cli_id) values(7, "2021-07-01", 1, 3, 2);



-- modificar datos
update mesero set mes_nombre = "Carlos", mes_apellidos = "Perez" where mes_id = 1;
update plato set plt_precio = 250000 where plt_id = 2;
delete from orden where ordn_id = 6;

-- consulta de datos
select ordn_id from orden where MESERO_mes_id = 2;
select ordn_id, ordn_fecha, PLATO_plt_id, CLIENTE_cli_id, MESERO_mes_id from orden where plato_plt_id = 4 order by ordn_fecha desc ;
select plt_id from plato where plt_precio > 20000;
select sum(plt_precio) from plato where TIPO_PLATO_tp_plt_id = 1 or TIPO_PLATO_tp_plt_id = 2;

